# Charless命令セット

## 特殊なオペコードとプレフィックス

### `20`: セパレータ

- 命令や引数を区切るためのセパレータです。

### `99`: 数値リテラルプレフィックス

- 次に来るのが数値リテラルであることを示します。
- 例: `51209912320` は `123` という数値をプッシュします。

## 00: 終了命令

- `00` は、コンパイラを終了する命令

## 0x: 出力系

### `01`: 文字列出力

<!-- printf("%s", "ab"); -->

- `0120[文字列の長さ][文字列本体]20`
- 例: `012029729820` → `"ab"`を出力

### `02`: 数値出力

- スタックの一番上にある値をポップして、それを10進数の数字としてコンソールに出力する
- 例: `51209912320` → `51209912320`(push 123) `0220` (出力)  → `123` を出力

### `03`: メモリ中の文字列出力

- スタックの一番上に格納されたメモリアドレスをポップし、そのアドレスが指す文字列を出力する
- 例: (実行時に文字列のアドレスをスタックにプッシュしてから) `0320` で出力

### `04`: 文字出力

- スタックの一番上にある値をポップして、それを1バイトの文字として出力する
- 例: `51209997120 0420` など（`51`で値をプッシュしてから`04 20`で出力）

## 1x: 入力系

### `11`: 文字入力

<!-- scanf("%c", str); -->
- ユーザーに文字の入力を求め、入力された文字をメモリに格納し、格納したメモリアドレスをスタックにプッシュする

### `12`: 数値入力

<!-- scanf("%d", &num); -->
- ユーザーに数値の入力を求め、入力された数値をスタックにプッシュする

### `13`: 文字列入力

<!-- scanf("%s", str); -->
- ユーザーに文字列の入力を求め、入力された文字列をメモリに格納し、格納したメモリアドレスをスタックにプッシュする

## 2x: 特殊出力系

### `21`: 改行文字出力

- 改行文字を出力する
- 例: `2120`

## 5x: スタック・メモリ系

### `51`: PUSH

- スタックに値をプッシュする
- 例: `51209912320` → push 123

### `52`: POP

- スタックから値をポップする
- 例: `5220` → pop

### `53`: STORE

- スタックの一番上にある値をメモリに格納する
- 例: `532099[変数ID]20` → スタックから値を一つポップし、指定されたIDの「変数ストレージ」に保存する。

### `54`: LOAD

- メモリから値をロードする
- 例: `542099[変数ID]20` → 指定されたIDの「変数ストレージ」から値を読み出し、スタックにプッシュする。

## 6x: 算術演算系

### `61`: ADD

- スタックから2つの値を取り出し、それらを足し合わせた値をスタックにプッシュする
- 例: `6120`

### `62`: SUB

- スタックから2つ値をポップし、演算した結果をプッシュする
- 例: `6220`

### `63`: MUL

- スタックから2つ値をポップし、乗算した結果をプッシュする
- 例: `6320`

### `64`: DIV

- スタックから2つ値をポップし、除算した結果をプッシュする
- 例: `6420`

### `65`: MOD

- スタックから2つ値をポップし、剰余した結果をプッシュする
- 例: `6520`

## 7x: 制御系

### `71`: JUMP

- 指定されたアドレスに無条件にジャンプする
- 例: `712099[アドレス]20`

### `72`: JZ

- スタックから値を一つポップしそれが`0`だったら指定のアドレスにジャンプする
- 例: `722099[アドレス]20`

### `73`: JNZ

- スタックから値を一つポップしそれが`0`でなければ指定のアドレスにジャンプする
- 例: `732099[アドレス]20`

## 8x: 比較演算系

### `81`: EQS

- スタックから2つ値をポップし、等しければ`1`、異なっていれば`0`をスタックにプッシュする
- 文字列比較にしか使えない
- 例: `8120`

### `82`: EQN

- スタックから2つ値をポップし、等しくないなら`1`、同じなら`0`をスタックにプッシュする
- 数字比較にしか使えない
- 例: `8220`

### `83`: GT

- スタックから2つ値をポップし、左辺が右辺より大きければ`1`、そうでなければ`0`をスタックにプッシュする
- 例: `8320`

### `84`: LT

- スタックから2つ値をポップし、左辺が右辺より小さければ`1`、そうでなければ`0`をスタックにプッシュする
- 例: `8420`

### `85`: GTE

- スタックから2つ値をポップし、左辺が右辺以上ならら`1`、そうでなければ`0`をスタックにプッシュする
- 例: `8520`

### `86`: LTE

- スタックから2つ値をポップし、左辺が右辺以下ならら`1`、そうでなければ`0`をスタックにプッシュする
- 例: `8620`

## コメント

### `97`: 一行コメント

- `9720` から行末までをコメントとして扱います。
- 例: `9720299311131093109310131103116`

### `98`: 複数行コメント

- `9820` から次の `9820` までをコメントとして扱います。
- 例:
  ```
  9820
  299311131093109310131103116
  9820
  ```