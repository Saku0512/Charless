# Charless命令セット

## 00: 終了命令

- `00` は、コンパイラを終了する命令

## 0x: 出力系

### `01`: 文字列出力

<!-- printf("%s", "ab"); -->

- `0120[文字列の長さ][文字列本体]20`
- 例: `012029729820` $\rightarrow$ `"ab"`を出力

### `02`: 数値出力

- スタックの一番上にある値をポップして、それを10進数の数字としてコンソールに出力する
- 例: `51209912320` $\rightarrow$ `51209912320`(push 123) `0220` (出力)  $\rightarrow$ `123` を出力

### `03`: メモリ中の文字列出力

- スタックの一番上に格納されたメモリアドレスをポップし、そのアドレスが指す文字列を出力する
- 例: (実行時に文字列のアドレスをスタックにプッシュしてから) `0320` で出力

### `04`: 文字出力

- スタックの一番上にある値をポップして、それを1バイトの文字として出力する
- 例: `51209997120 0420` など（`51`で値をプッシュしてから`04 20`で出力）

## 1x: 入力系

### `11`: 文字入力

<!-- scanf("%c", str); -->
- ユーザーに文字の入力を求め、入力された文字をメモリに格納し、格納したメモリアドレスをスタックにプッシュする

### `12`: 数値入力

<!-- scanf("%d", &num); -->
- ユーザーに数値の入力を求め、入力された数値をスタックにプッシュする

### `13`: 文字列入力

<!-- scanf("%s", str); -->
- ユーザーに文字列の入力を求め、入力された文字列をメモリに格納し、格納したメモリアドレスをスタックにプッシュする

## 5x: スタック・メモリ系

### `51`: PUSH

- スタックに値をプッシュする
- 例: `51209912320` $\rightarrow$ push 123

注意: コンパイラ実装では `51` の直後に数値リテラルを示すために `99` プレフィックスが必要です（形式: `51 20 99 <数値リテラル> 20` のように区切りが入る）。バイトコード生成側はこのフォーマットに従ってください。

### `52`: POP

- スタックから値をポップする
- 例: `5220` $\rightarrow$ pop

### `53`: STORE

- スタックの一番上にある値をメモリに格納する
- 例: `532099[変数ID]20` $\rightarrow$ スタックから値を一つポップし、指定されたIDの「変数ストレージ」に保存する。

注意: 実装では `53` の後に `99` プレフィックス + 変数ID の数値リテラルが必要です（例: `53 20 99 <id> 20`）。

### `54`: LOAD

- メモリから値をロードする
- 例: `542099[変数ID]20` $\rightarrow$ 指定されたIDの「変数ストレージ」から値を読み出し、スタックにプッシュする。

注意: 実装では `54` の後に `99` プレフィックス + 変数ID の数値リテラルが必要です（例: `54 20 99 <id> 20`）。

## 6x: 算術演算系

### `61`: ADD

- スタックから2つの値を取り出し、それらを足し合わせた値をスタックにプッシュする
- 例: `6120`

### `62`: SUB

- スタックから2つ値をポップし、演算した結果をプッシュする
- 例: `6220`

### `63`: MUL

- スタックから2つ値をポップし、乗算した結果をプッシュする
- 例: `6320`

### `64`: DIV

- スタックから2つ値をポップし、除算した結果をプッシュする
- 例: `6420`

### `65`: MOD

- スタックから2つ値をポップし、剰余した結果をプッシュする
- 例: `6520`

## 7x: 制御系

### `71`: JUMP

- 指定されたアドレスに無条件にジャンプする
- 例: `712099[アドレス]20`

### `72`: JZ

- スタックから値を一つポップしそれが`0`だったら指定のアドレスにジャンプする
- 例: `722099[アドレス]20`

### `73`: JNZ

- スタックから値を一つポップしそれが`0`でなければ指定のアドレスにジャンプする
- 例: `732099[アドレス]20`

## 8x: 比較演算系

### `81`: EQS

- スタックから2つ値をポップし、等しければ`1`、異なっていれば`0`をスタックにプッシュする
- 文字列比較にしか使えない
- 例: `8120`

### `82`: EQN

- スタックから2つ値をポップし、等しくないなら`1`、同じなら`0`をスタックにプッシュする
- 数字比較にしか使えない
- 例: `8220`

### `83`: GT

- スタックから2つ値をポップし、左辺が右辺より大きければ`1`、そうでなければ`0`をスタックにプッシュする
- 例: `8320`

### `84`: LT

- スタックから2つ値をポップし、左辺が右辺より小さければ`1`、そうでなければ`0`をスタックにプッシュする
- 例: `8420`

### `85`: GTE

- スタックから2つ値をポップし、左辺が右辺以上ならら`1`、そうでなければ`0`をスタックにプッシュする
- 例: `8520`

### `86`: LTE

- スタックから2つ値をポップし、左辺が右辺以下ならら`1`、そうでなければ`0`をスタックにプッシュする
- 例: `8620`

